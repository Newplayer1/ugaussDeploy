{"version":3,"sources":["App.js","index.js","store/store.js","MQTT/mqtt.js","endpoint/object.js"],"names":["require","config","defaults","baseURL","loading","className","TheLayout","React","lazy","memo","Suspense","fallback","path","name","render","props","store","dispatch","getDevices","ReactDOM","document","getElementById","getObjects","composedEnhancer","composeWithDevTools","applyMiddleware","thunkMiddleware","initialState","sidebarShow","devices","editMode","isLog","getState","a","response","console","log","type","data","createStore","state","rest","mqttOption","port","keepalive","protocolId","protocolVersion","clean","reconnectPeriod","connectTimeout","username","password","will","topic","payload","qos","retain","rejectUnauthorized","clientId","Donnees","useState","client","setClient","useDispatch","useEffect","mqtt","connect","mqttSub","subscribe","error","on","message","charge_Profiles","JSON","parse","toString","readings","source_Profiles","axios","nameFct","request","url","method","headers","Authorization","cookies","get","then","err","catch","res","addObject","editObject"],"mappings":"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","file":"static/js/main.5acbaa70.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { HashRouter, Route, Switch } from \"react-router-dom\";\r\nimport \"./scss/style.scss\";\r\nimport ConnectMQTT from \"./MQTT/mqtt.js\";\r\n\r\nrequire(\"dotenv\").config();\r\nconst axios = require(\"axios\");\r\naxios.defaults.baseURL = \"https://ugauss.herokuapp.com/api\"; //\"http://localhost:3001/api\";\r\n\r\nconst loading = (\r\n  <div className=\"pt-3 text-center\">\r\n    <div className=\"sk-spinner sk-spinner-pulse\"></div>\r\n  </div>\r\n);\r\n\r\n// Containers\r\nconst TheLayout = React.lazy(() => import(\"./containers/TheLayout\"));\r\n\r\nconst App = () => {\r\n  return (\r\n    <HashRouter>\r\n      <React.Suspense fallback={loading}>\r\n        <Switch>\r\n          <Route path=\"/\" name=\"Home\" render={(props) => <TheLayout {...props} />} />\r\n          <ConnectMQTT />\r\n        </Switch>\r\n      </React.Suspense>\r\n    </HashRouter>\r\n  );\r\n};\r\nexport default React.memo(App);\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\n\r\nimport { Provider } from \"react-redux\";\r\nimport store from \"./store/store\";\r\n\r\nimport { getDevices } from \"./store/store\";\r\nrequire(\"dotenv\").config();\r\n\r\nstore.dispatch(getDevices);\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById(\"root\")\r\n);\r\n","import { createStore, applyMiddleware } from \"redux\";\r\nimport thunkMiddleware from \"redux-thunk\";\r\nimport { composeWithDevTools } from \"redux-devtools-extension\";\r\nconst { getObjects } = require(\"../endpoint/object\");\r\n\r\nconst composedEnhancer = composeWithDevTools(applyMiddleware(thunkMiddleware));\r\n\r\nconst initialState = {\r\n  sidebarShow: \"responsive\",\r\n  devices: [],\r\n  editMode: null,\r\n  isLog: false,\r\n};\r\n\r\nexport async function getDevices(dispatch, getState) {\r\n  const response = await getObjects(\"/device\");\r\n  if (response) {\r\n    console.log(response);\r\n    dispatch({ type: \"device/getDevices\", devices: response.data });\r\n    dispatch({ type: \"login/isLog\", isLog: true });\r\n  } else {\r\n    dispatch({ type: \"login/isLog\", isLog: false });\r\n  }\r\n}\r\n\r\nconst changeState = (state = initialState, { type, ...rest }) => {\r\n  switch (type) {\r\n    case \"setNavbar\":\r\n      return { ...state, ...rest };\r\n\r\n    case \"editMode\":\r\n      return { ...state, ...rest };\r\n    case \"device/getDevices\":\r\n      return { ...state, ...rest };\r\n    case \"login/isLog\":\r\n      return { ...state, ...rest };\r\n    case \"[Readings] message\":\r\n      return { ...state, ...rest };\r\n    case \"[Charge_Profile] message\":\r\n      return { ...state, ...rest };\r\n    case \"[Source_Profile] message\":\r\n      return { ...state, ...rest };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nconst store = createStore(changeState, composedEnhancer);\r\nexport default store;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport mqtt from \"mqtt\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nconst host = \"wss://driver.cloudmqtt.com\";\r\nconst mqttOption = {\r\n  port: 38909,\r\n  keepalive: 30,\r\n  protocolId: \"MQTT\",\r\n  protocolVersion: 4,\r\n  clean: true,\r\n  reconnectPeriod: 1000,\r\n  connectTimeout: 30 * 1000,\r\n  username: \"dhvvrehu\",\r\n  password: \"10T74SxY2TX2\",\r\n  will: {\r\n    topic: \"WillMsg\",\r\n    payload: \"Connection Closed abnormally..!\",\r\n    qos: 0,\r\n    retain: false,\r\n  },\r\n  rejectUnauthorized: false,\r\n  clientId: \"mqttjs_webClient\",\r\n};\r\n\r\nconst Donnees = () => {\r\n  const [client, setClient] = useState(null);\r\n  const [payload, setPayload] = useState({});\r\n  const [connectStatus, setConnectStatus] = useState(\"Connect\");\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    setClient(mqtt.connect(host, mqttOption));\r\n  }, []);\r\n  useEffect(() => {\r\n    mqttSub();\r\n  }, [client]);\r\n\r\n  const mqttSub = () => {\r\n    console.log(client);\r\n    if (client) {\r\n      var topic = \"Readings\";\r\n      const qos = 0;\r\n      client.subscribe(topic, { qos }, (error) => {\r\n        if (error) {\r\n          console.log(\"Subscribe to topics error\", error);\r\n          return;\r\n        }\r\n        console.log(\"object\");\r\n      });\r\n      topic = \"Source_Profile\";\r\n      client.subscribe(topic, { qos }, (error) => {\r\n        if (error) {\r\n          console.log(\"Subscribe to topics error\", error);\r\n          return;\r\n        }\r\n        console.log(\"object\");\r\n      });\r\n      topic = \"Charge_Profile\";\r\n      client.subscribe(topic, { qos }, (error) => {\r\n        if (error) {\r\n          console.log(\"Subscribe to topics error\", error);\r\n          return;\r\n        }\r\n        console.log(\"object\");\r\n      });\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    if (client) {\r\n      client.on(\"message\", (topic, message) => {\r\n        console.log(\"test\");\r\n        switch (topic) {\r\n          case \"Charge_Profile\":\r\n            dispatch({\r\n              type: \"[Charge_Profile] message\",\r\n              charge_Profiles: JSON.parse(message.toString()),\r\n            });\r\n            break;\r\n          case \"Readings\":\r\n            dispatch({\r\n              type: \"[Readings] message\",\r\n              readings: JSON.parse(message.toString()),\r\n            });\r\n            break;\r\n          case \"Source_Profile\":\r\n            dispatch({\r\n              type: \"[Source_Profile] message\",\r\n              source_Profiles: JSON.parse(message.toString()),\r\n            });\r\n            break;\r\n        }\r\n      });\r\n    }\r\n  }, [client]);\r\n  return <></>;\r\n};\r\n\r\nexport default Donnees;\r\n","import cookies from \"js-cookie\";\r\nconst axios = require(\"axios\");\r\n\r\nexport async function getObjects(nameFct) {\r\n  let res = await axios\r\n    .request({\r\n      url: nameFct,\r\n      method: \"get\",\r\n      headers: { Authorization: `Bearer ${cookies.get(\"jwt\")}` },\r\n    })\r\n    .then((response, err) => {\r\n      if (!err) {\r\n        return response;\r\n      }\r\n    })\r\n    .catch((error) => {\r\n      console.log(error);\r\n    });\r\n  return res;\r\n}\r\n\r\nexport async function addObject(nameFct, data) {\r\n  return axios({\r\n    url: nameFct,\r\n    method: \"post\",\r\n    data,\r\n    headers: { Authorization: `Bearer ${cookies.get(\"jwt\")}` },\r\n  })\r\n    .then((response) => {\r\n      console.log(response);\r\n    })\r\n    .catch((error) => {\r\n      console.log(error);\r\n    });\r\n}\r\n\r\nexport async function editObject(nameFct, data) {\r\n  return axios({\r\n    url: nameFct,\r\n    method: \"put\",\r\n    data,\r\n    headers: { Authorization: `Bearer ${cookies.get(\"jwt\")}` },\r\n  })\r\n    .then((response) => {\r\n      console.log(response);\r\n    })\r\n    .catch((error) => {\r\n      console.log(error);\r\n    });\r\n}\r\n"],"sourceRoot":""}