{"version":3,"sources":["endpoint/object.js","endpoint/users.js","store/store.js","App.js","index.js","MQTT/mqtt.js"],"names":["axios","require","getObjects","nameFct","a","request","url","method","headers","Authorization","cookies","get","then","response","err","catch","error","console","log","res","addObject","data","editObject","exports","login","info","post","verify","cookie","check","composedEnhancer","composeWithDevTools","applyMiddleware","thunkMiddleware","initialState","sidebarShow","devices","editMode","isLog","getDevices","dispatch","getState","type","store","createStore","state","rest","config","defaults","baseURL","loading","className","TheLayout","React","lazy","Login","window","location","protocol","memo","useSelector","useDispatch","Suspense","fallback","path","name","render","props","onLogin","username","password","result","set","ReactDOM","document","getElementById","mqttOption","port","keepalive","protocolId","protocolVersion","clean","reconnectPeriod","connectTimeout","will","topic","payload","qos","retain","rejectUnauthorized","clientId","Donnees","useState","client","setClient","useEffect","mqtt","connect","mqttSub","subscribe","on","message","charge_Profiles","JSON","parse","toString","readings","source_Profiles"],"mappings":"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","file":"static/js/main.6e646d41.chunk.js","sourcesContent":["import cookies from \"js-cookie\";\r\nconst axios = require(\"axios\");\r\n\r\nexport async function getObjects(nameFct) {\r\n  let res = await axios\r\n    .request({\r\n      url: nameFct,\r\n      method: \"get\",\r\n      headers: { Authorization: `Bearer ${cookies.get(\"jwt\")}` },\r\n    })\r\n    .then((response, err) => {\r\n      if (!err) {\r\n        return response;\r\n      }\r\n    })\r\n    .catch((error) => {\r\n      console.log(error);\r\n    });\r\n  return res;\r\n}\r\n\r\nexport async function addObject(nameFct, data) {\r\n  return axios({\r\n    url: nameFct,\r\n    method: \"post\",\r\n    data,\r\n    headers: { Authorization: `Bearer ${cookies.get(\"jwt\")}` },\r\n  })\r\n    .then((response) => {\r\n      console.log(response);\r\n    })\r\n    .catch((error) => {\r\n      console.log(error);\r\n    });\r\n}\r\n\r\nexport async function editObject(nameFct, data) {\r\n  return axios({\r\n    url: nameFct,\r\n    method: \"put\",\r\n    data,\r\n    headers: { Authorization: `Bearer ${cookies.get(\"jwt\")}` },\r\n  })\r\n    .then((response) => {\r\n      console.log(response);\r\n    })\r\n    .catch((error) => {\r\n      console.log(error);\r\n    });\r\n}\r\n","const axios = require(\"axios\");\r\n\r\nexports.login = (info) => {\r\n  return axios\r\n    .post(\"/user/login\", info)\r\n    .then((response) => {\r\n      return response;\r\n    })\r\n    .catch((error) => {\r\n      console.log(error);\r\n    });\r\n};\r\nexports.verify = (cookie, check) => {\r\n  axios\r\n    .request({\r\n      url: \"/user/verify\",\r\n      method: \"post\",\r\n      headers: { Authorization: `Bearer ${cookie}` },\r\n      data: { check },\r\n    })\r\n    .then((response) => {})\r\n    .catch((error) => {\r\n      console.log(error);\r\n    });\r\n};\r\n","import { createStore, applyMiddleware } from \"redux\";\r\nimport thunkMiddleware from \"redux-thunk\";\r\nimport { composeWithDevTools } from \"redux-devtools-extension\";\r\nconst { getObjects } = require(\"../endpoint/object\");\r\n\r\nconst composedEnhancer = composeWithDevTools(applyMiddleware(thunkMiddleware));\r\n\r\nconst initialState = {\r\n  sidebarShow: \"responsive\",\r\n  devices: [],\r\n  editMode: null,\r\n  isLog: false,\r\n};\r\n\r\nexport async function getDevices(dispatch, getState) {\r\n  const response = await getObjects(\"/device\");\r\n  if (response) {\r\n    console.log(response);\r\n    dispatch({ type: \"device/getDevices\", devices: response.data });\r\n    dispatch({ type: \"login/isLog\", isLog: true });\r\n  } else {\r\n    dispatch({ type: \"login/isLog\", isLog: false });\r\n  }\r\n}\r\n\r\nconst changeState = (state = initialState, { type, ...rest }) => {\r\n  switch (type) {\r\n    case \"setNavbar\":\r\n      return { ...state, ...rest };\r\n\r\n    case \"editMode\":\r\n      return { ...state, ...rest };\r\n    case \"device/getDevices\":\r\n      return { ...state, ...rest };\r\n    case \"login/isLog\":\r\n      return { ...state, ...rest };\r\n    case \"[Readings] message\":\r\n      return { ...state, ...rest };\r\n    case \"[Charge_Profile] message\":\r\n      return { ...state, ...rest };\r\n    case \"[Source_Profile] message\":\r\n      return { ...state, ...rest };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nconst store = createStore(changeState, composedEnhancer);\r\nexport default store;\r\n","import React from \"react\";\r\nimport { HashRouter, Route, Switch } from \"react-router-dom\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport cookies from \"js-cookie\";\r\nimport \"./scss/style.scss\";\r\nimport store from \"./store/store\";\r\nimport { getDevices } from \"./store/store\";\r\nimport ConnectMQTT from \"./MQTT/mqtt.js\";\r\n\r\nrequire(\"dotenv\").config();\r\nconst axios = require(\"axios\");\r\naxios.defaults.baseURL = \"https://ugauss.herokuapp.com/api\"; //\"http://localhost:3001/api\";\r\n\r\nconst loading = (\r\n  <div className=\"pt-3 text-center\">\r\n    <div className=\"sk-spinner sk-spinner-pulse\"></div>\r\n  </div>\r\n);\r\nconst { login, verify } = require(\"./endpoint/users\");\r\n\r\n// Containers\r\nconst TheLayout = React.lazy(() => import(\"./containers/TheLayout\"));\r\n\r\nconst secure = window.location.protocol === \"https\";\r\n\r\n// Pages\r\nconst Login = React.lazy(() => import(\"./views/pages/login/Login\"));\r\n\r\nconst App = () => {\r\n  const isLog = useSelector((state) => state.isLog);\r\n  const dispatch = useDispatch();\r\n\r\n  const onLogin = (username, password) => {\r\n    login({ username, password }).then((result) => {\r\n      if (result) {\r\n        cookies.set(\"jwt\", result.data);\r\n        dispatch({ type: \"login/isLog\", isLog: true });\r\n        store.dispatch(getDevices);\r\n      }\r\n    });\r\n  };\r\n\r\n  return (\r\n    <HashRouter>\r\n      <React.Suspense fallback={loading}>\r\n        <Switch>\r\n          {!isLog ? (\r\n            <Route path=\"/\" name=\"login\" render={(props) => <Login {...props} onLogin={(username, password) => onLogin(username, password)} />} />\r\n          ) : (\r\n            <>\r\n              <Route path=\"/\" name=\"Home\" render={(props) => <TheLayout {...props} />} />\r\n              <ConnectMQTT />\r\n            </>\r\n          )}\r\n        </Switch>\r\n      </React.Suspense>\r\n    </HashRouter>\r\n  );\r\n};\r\nexport default React.memo(App);\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\n\r\nimport { Provider } from \"react-redux\";\r\nimport store from \"./store/store\";\r\n\r\nimport { getDevices } from \"./store/store\";\r\nrequire(\"dotenv\").config();\r\n\r\nstore.dispatch(getDevices);\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById(\"root\")\r\n);\r\n","import React, { useEffect, useState } from \"react\";\r\nimport mqtt from \"mqtt\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nconst host = \"wss://driver.cloudmqtt.com\";\r\nconst mqttOption = {\r\n  port: 38909,\r\n  keepalive: 30,\r\n  protocolId: \"MQTT\",\r\n  protocolVersion: 4,\r\n  clean: true,\r\n  reconnectPeriod: 1000,\r\n  connectTimeout: 30 * 1000,\r\n  username: \"dhvvrehu\",\r\n  password: \"10T74SxY2TX2\",\r\n  will: {\r\n    topic: \"WillMsg\",\r\n    payload: \"Connection Closed abnormally..!\",\r\n    qos: 0,\r\n    retain: false,\r\n  },\r\n  rejectUnauthorized: false,\r\n  clientId: \"mqttjs_webClient\",\r\n};\r\n\r\nconst Donnees = () => {\r\n  const [client, setClient] = useState(null);\r\n  const [payload, setPayload] = useState({});\r\n  const [connectStatus, setConnectStatus] = useState(\"Connect\");\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    setClient(mqtt.connect(host, mqttOption));\r\n  }, []);\r\n  useEffect(() => {\r\n    mqttSub();\r\n  }, [client]);\r\n\r\n  const mqttSub = () => {\r\n    console.log(client);\r\n    if (client) {\r\n      var topic = \"Readings\";\r\n      const qos = 0;\r\n      client.subscribe(topic, { qos }, (error) => {\r\n        if (error) {\r\n          console.log(\"Subscribe to topics error\", error);\r\n          return;\r\n        }\r\n        console.log(\"object\");\r\n      });\r\n      topic = \"Source_Profile\";\r\n      client.subscribe(topic, { qos }, (error) => {\r\n        if (error) {\r\n          console.log(\"Subscribe to topics error\", error);\r\n          return;\r\n        }\r\n        console.log(\"object\");\r\n      });\r\n      topic = \"Charge_Profile\";\r\n      client.subscribe(topic, { qos }, (error) => {\r\n        if (error) {\r\n          console.log(\"Subscribe to topics error\", error);\r\n          return;\r\n        }\r\n        console.log(\"object\");\r\n      });\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    if (client) {\r\n      client.on(\"message\", (topic, message) => {\r\n        switch (topic) {\r\n          case \"Charge_Profile\":\r\n            dispatch({\r\n              type: \"[Charge_Profile] message\",\r\n              charge_Profiles: JSON.parse(message.toString()),\r\n            });\r\n            break;\r\n          case \"Readings\":\r\n            dispatch({\r\n              type: \"[Readings] message\",\r\n              readings: JSON.parse(message.toString()),\r\n            });\r\n            break;\r\n          case \"Source_Profile\":\r\n            dispatch({\r\n              type: \"[Source_Profile] message\",\r\n              source_Profiles: JSON.parse(message.toString()),\r\n            });\r\n            break;\r\n        }\r\n      });\r\n    }\r\n  }, [client]);\r\n  return <></>;\r\n};\r\n\r\nexport default Donnees;\r\n"],"sourceRoot":""}